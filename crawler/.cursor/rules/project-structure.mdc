# GoCrawl Project Structure

This is a Go web crawler and search engine project with the following architecture:

## Main Entry Points
- [main.go](mdc:main.go) - Application entry point that executes the root command
- [cmd/root.go](mdc:cmd/root.go) - Root command structure using Cobra CLI framework

## Command Structure (cmd/)
- `crawl/` - Web crawling functionality
- `httpd/` - HTTP server and API endpoints
- `index/` - Content indexing operations
- `scheduler/` - Job scheduling for automated crawling
- `search/` - Search functionality
- `sources/` - Source management
- `common/` - Shared command utilities (CommandDeps, factory functions, constants)

**Command Architecture:**
- All commands use `Command()` function pattern for registration
- Dependencies created via `common.NewCommandDeps()` factory
- Commands construct dependencies directly (no FX, no context.Value)
- Storage clients created via `common.CreateStorageClient()`
- Constants defined in `internal/constants/constants.go`
- See command-architecture.mdc for detailed patterns

## Core Components (internal/)
- `crawler/` - Web crawling engine using Colly (includes events subsystem)
- `storage/` - Elasticsearch storage layer (includes types and index management)
- `sources/` - Source configuration and management (includes types package and utilities: ConvertSourceConfig, ExtractDomain)
- `processor/` - Content processing and extraction
- `content/` - Content handling with articles and pages sub-packages
- `domain/` - Domain models and data structures (Article, Page, Content, Job)
- `constants/` - Shared constants organized by domain (HTTP, Crawler, Storage, Logger, General)
- `api/` - REST API implementation using Gin (includes middleware, lifecycle management)
- `config/` - Configuration management using Viper (includes sub-packages for app, server, crawler, elasticsearch, logging)
- `logger/` - Logging using Zap
- `metrics/` - Application metrics and monitoring
- `job/` - Job management and scheduling (includes Service interface and BaseService implementation)
- `common/` - Common utilities (only transport subpackage: TLS utilities and transport constants re-exports)

## Configuration
- [config.example.yaml](mdc:config.example.yaml) - Main configuration template
- [sources.example.yml](mdc:sources.example.yml) - Source configuration template with comprehensive selector examples
- [.env.example](mdc:.env.example) - Environment variables template
- See sources-configuration.mdc for detailed selector field documentation

## Dependencies
- Web crawling: `github.com/gocolly/colly/v2`
- HTTP framework: `github.com/gin-gonic/gin`
- Search engine: `github.com/elastic/go-elasticsearch/v8`
- CLI framework: `github.com/spf13/cobra`
- Configuration: `github.com/spf13/viper`
- Logging: `go.uber.org/zap`
- Dependency injection: Explicit dependency passing (FX removed from codebase)
description:
globs:
alwaysApply: true
---
